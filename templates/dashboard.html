{% extends "base.html" %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
  <h1 class="display-6 fw-bold mb-0">Dashboard</h1>
  <a href="/add" class="btn btn-primary btn-lg shadow-sm">
    <i class="bi bi-plus-lg"></i> Add Reading
  </a>
</div>

<div class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4">
  {% for card in tank_cards %}
  <div class="col">
    <div class="card h-100 shadow-sm border-0 hover-shadow transition-all">
      <div class="card-header bg-white border-bottom-0 pt-3 pb-0">
        <div class="d-flex justify-content-between align-items-start">
          <div>
            <h2 class="h4 fw-bold text-primary mb-1">
              <a href="/tanks/{{ card.tank.id }}" class="text-decoration-none">{{ card.tank.name }}</a>
            </h2>
            <div class="text-muted small">
              {% if card.tank.volume_l %}
                <span class="badge bg-light text-secondary border">{{ card.tank.volume_l }} L</span>
              {% endif %}
              {% if card.latest %}
                Last test: {{ card.latest.taken_at|dtfmt }}
              {% else %}
                No data yet
              {% endif %}
            </div>
          </div>
        </div>
      </div>
      
      <div class="card-body pt-3">
        {% if card.readings %}
          <div class="row row-cols-2 g-2">
            {% for r in card.readings[:6] %}
            <div class="col">
              <div class="p-2 rounded bg-light border d-flex justify-content-between align-items-center">
                <span class="small fw-bold text-secondary text-uppercase" style="font-size: 0.75rem;">{{ r.name }}</span>
                <span class="fw-bold">{{ r.value|fmt2 }} <small class="text-muted fw-normal">{{ r.unit }}</small></span>
              </div>
            </div>
            {% endfor %}
          </div>
          {% if card.readings|length > 6 %}
            <div class="text-center mt-2">
              <a href="/tanks/{{ card.tank.id }}" class="small text-decoration-none text-muted">
                + {{ card.readings|length - 6 }} more parameters
              </a>
            </div>
          {% endif %}
        {% else %}
          <div class="text-center py-4 text-muted bg-light rounded">
            <p class="mb-0">No parameters logged.</p>
            <a href="/tanks/{{ card.tank.id }}/add" class="btn btn-sm btn-outline-primary mt-2">Log First Test</a>
          </div>
        {% endif %}
      </div>
      
      <div class="card-footer bg-white border-top-0 pb-3 text-end">
        <a href="/tanks/{{ card.tank.id }}" class="btn btn-sm btn-outline-secondary">View History</a>
        <a href="/tanks/{{ card.tank.id }}/add" class="btn btn-sm btn-primary">Log Test</a>
      </div>
    </div>
  </div>
  {% endfor %}
  
  <div class="col">
    <div class="card h-100 shadow-sm border-2 border-dashed border-secondary-subtle d-flex align-items-center justify-content-center bg-light" style="min-height: 200px;">
      <a href="/tanks/new" class="text-decoration-none text-center p-4 w-100 h-100 d-flex flex-column justify-content-center">
        <div class="display-4 text-secondary mb-2"><i class="bi bi-plus-circle"></i></div>
        <h5 class="fw-bold text-secondary">Add New Tank</h5>
      </a>
    </div>
  </div>
</div>

<style>
.hover-shadow:hover { transform: translateY(-2px); box-shadow: 0 .5rem 1rem rgba(0,0,0,.15)!important; }
.transition-all { transition: all 0.2s ease-in-out; }
</style>
{% endblock %}
