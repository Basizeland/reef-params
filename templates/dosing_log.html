{% extends "base.html" %}
{% block content %}
<h2>Dosing Log: {{ tank.name }}</h2>
<div class="row mt-4">
  <div class="col-md-4 mb-4">
    <div class="card p-3 shadow-sm">
      <h5>Log Dose</h5>
      <form method="post">
        <div class="mb-2">
           <label>Date/Time</label>
           <input type="datetime-local" name="logged_at" class="form-control">
        </div>
        <div class="mb-2">
           <label>Additive</label>
           <select name="additive_id" class="form-select" required>
             {% for a in additives %}<option value="{{ a.id }}">{{ a.name }}</option>{% endfor %}
           </select>
        </div>
        <div class="mb-2">
           <label>Amount (ml)</label>
           <input type="number" step="any" name="amount_ml" class="form-control" required>
        </div>
        <div class="mb-3">
           <label>Reason</label>
           <input type="text" name="reason" class="form-control">
        </div>
        <button type="submit" class="btn btn-success w-100">Log</button>
      </form>
    </div>
  </div>
  <div class="col-md-8">
    <table class="table table-striped">
      <thead><tr><th>Date</th><th>Additive</th><th>Amount</th><th>Reason</th><th>Action</th></tr></thead>
      <tbody>
        {% for l in logs %}
        <tr>
          <td>{{ l.logged_at_dt|dtfmt }}</td>
          <td>{{ l.additive_name }}</td>
          <td>{{ l.amount_ml }}</td>
          <td>{{ l.reason or "" }}</td>
          <td>
            <form method="post" action="/dose-logs/{{ l.id }}/delete" onsubmit="return confirm('Delete?');">
              <input type="hidden" name="tank_id" value="{{ tank.id }}">
              <button class="btn btn-sm btn-outline-danger">Del</button>
            </form>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
